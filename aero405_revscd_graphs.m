%% large ball
close all

reb90 = [4807.593723 14999.69242 20576.50113 25961.0061 31730.11857 37018.47167 42306.82476 47499.02598];
cdb90 = [3.614695332 1.055211791 0.749714822 0.8545130998 0.8960233621 0.8379529597 0.7962954026 0.8363170902];

semilogx(reb90,cdb90, "-o");
hold on;

reb75 = [4422.986225 14422.78117 20768.80488 25961.0061 31537.81482 36730.01604 42306.82476 47306.72223];
cdb75 = [3.326838767 0.8233412321 0.8357756949 0.8819088131 0.9193595311 0.9424076514 0.8547518549 0.9173846789];

semilogx(reb75,cdb75, "-*");

reb60 = [4807.593723 14999.69242 20961.10863 26153.30985 31730.11857 36922.31979 42306.82476 47114.41849];
cdb60 = [0.1863840114 0.04804904626 0.04411413205 0.0464865535 0.04860953184 0.0471738619 0.04501277316 0.04495038146];

semilogx(reb60,cdb60, "-square");

reb45 = [4807.593723 14999.69242 20768.80488 26153.30985 31537.81482 36922.31979 40383.78727 47114.41849];
cdb45 = [3.348408999 0.8090151076 0.7501640908 0.7610099816 0.8265414774 0.8468376552 0.8022346322 0.7696198178];

semilogx(reb45,cdb45, "-pentagram");

reb30 = [4807.593723 14999.69242 20768.80488 26153.30985 31730.11857 36922.31979 42499.12851 47499.02598];
cdb30 = [2.815836332 0.5354632367 0.3363746712 0.3560952367 0.4681068486 0.426972933 0.4074579587 0.4189421027];

semilogx(reb30,cdb30, "-diamond");

reb15 = [4807.593723 14999.69242 20961.10863 26057.15798 31730.11857 37306.92729 42499.12851 47499.02598];
cdb15 = [2.815836332 0.617528798 0.302214986 0.3043402866 0.2480354988 0.1926892691 0.1587055999 0.1461479931];

semilogx(reb15,cdb15, "-^");

reb0 = [4807.593723 14999.69242 20961.10863 26345.6136 31537.81482 37114.62354 42499.12851 47499.02598];
cdb0 = [3.348408999 0.4807528625 0.2181670313 0.2711107077 0.226318063 0.1723511648 0.1212223678 0.1352362288];

semilogx(reb0,cdb0, "-v");

cdavg = [];
for i=1:8
    cdavg(i) = (cdb90(i)+cdb75(i)+cdb60(i)+cdb45(i)+cdb30(i)+cdb15(i)+cdb0(i))/7;
end

reavg =[];
for i=1:8
    reavg(i) = (reb90(i)+reb75(i)+reb60(i)+reb45(i)+reb30(i)+reb15(i)+reb0(i))/7;
end

semilogx(reavg,cdavg, "-o",'LineWidth',4);


legend("90^{o}","75^{o}","60^{o}","45^{o}","30^{o}","15^{o}","0^{o}", "Average");
xticks([10000 20000 40000]);
xticklabels({'10000', '20000', '400000'});

title("Re vs C_d for 30mm Ball");
xlabel("Reynolds Number");
ylabel("C_d");

%% medium ball
figure();
hold on;
rem0 = [4881.903424 13018.40913 17737.58244 22782.21598 27501.38929 32708.75294 37427.92625 40519.79842];
cdm0 = [0.6919670835 0.3143792759 0.1526438921 0.2950442739 0.3067065941 0.3445445516 0.2331232921 0.1252805699];

semilogx(rem0,cdm0, "-o")

rem15 = [12530.21879 22294.02564 31569.64214 40519.79842];
cdm15= [0.1719853169 0.2129404981 0.2643915066 0.2533206237];

semilogx(rem15,cdm15, "-*");

rem30 = [12367.48867 22131.29552 31244.18191 40357.06831];
cdm30 = [0.2109013553 0.4092266073 0.4529746748 0.4167110466];

semilogx(rem30,cdm30, "-square");

rem45 = [12692.9489 21968.56541 31406.91203 40357.06831];
cdm45 = [0.5916748259 0.6439959561 0.7786331456 0.7393978383];

semilogx(rem45,cdm45, "-pentagram");

rem60 = [12692.9489 22294.02564 31569.64214 40194.33819];
cdm60 = [0.7873999584 0.9319793035 1.002651147 0.9047964002];

semilogx(rem60,cdm60, "-diamond");

rem75 = [12367.48867 22131.29552 31732.37226 40194.33819];
cdm75 = [0.554504687 0.741861978 0.9245425341 0.8722659073];

semilogx(rem75,cdm75, "-^");

rem90 = [4881.903424 12692.9489 17737.58244 22131.29552 27013.19895 31569.64214 35963.35522 40357.06831];
cdm90 = [1.574035014 0.6569165368 0.6871855216 0.6774809385 0.8724660304 0.8760923512 0.7116725556 0.7426247062];

semilogx(rem90,cdm90, "-v");

cdmavg(1) = (cdm90(1)+cdm0(1))/2;
cdmavg(2) = (cdm90(2)+cdm0(2)+cdm15(1)+cdm30(1)+cdm45(1)+cdm60(1)+cdm75(1))/7;
cdmavg(3) = (cdm90(3)+cdm0(3))/2;
cdmavg(4) = (cdm90(4)+cdm0(4)+cdm15(2)+cdm30(2)+cdm45(2)+cdm60(2)+cdm75(2))/7;
cdmavg(5) = (cdm90(5)+cdm0(5))/2;
cdmavg(6) = (cdm90(6)+cdm0(6)+cdm15(3)+cdm30(3)+cdm45(3)+cdm60(3)+cdm75(3))/7;
cdmavg(7) = (cdm90(7)+cdm0(7))/2;
cdmavg(8) = (cdm90(8)+cdm0(8)+cdm15(4)+cdm30(4)+cdm45(4)+cdm60(4)+cdm75(4))/7;

remavg(1) = (rem90(1)+rem0(1))/2;
remavg(2) = (rem90(2)+rem0(2)+rem15(1)+rem30(1)+rem45(1)+rem60(1)+rem75(1))/7;
remavg(3) = (rem90(3)+rem0(3))/2;
remavg(4) = (rem90(4)+rem0(4)+rem15(2)+rem30(2)+rem45(2)+rem60(2)+rem75(2))/7;
remavg(5) = (rem90(5)+rem0(5))/2;
remavg(6) = (rem90(6)+rem0(6)+rem15(3)+rem30(3)+rem45(3)+rem60(3)+rem75(3))/7;
remavg(7) = (rem90(7)+rem0(7))/2;
remavg(8) = (rem90(8)+rem0(8)+rem15(4)+rem30(4)+rem45(4)+rem60(4)+rem75(4))/7;

semilogx(remavg,cdmavg, "-o",'LineWidth',4);

legend("0^{o}","15^{o}","30^{o}","45^{o}","60^{o}","75^{o}","90^{o}","Average");
title("Re vs C_d for 25mm ball");
xlabel("Reynolds Number");
ylabel("C_d");

%% small ball
figure();
hold on
res0= [2994.2341 10024.17503 14190.06595 17705.03642 21480.37507 25385.89781 28770.68418 32415.83874];
cds0= [-1.25622235 -0.1120832558 -0.2513621785 -0.1991242305 -0.04999483376 -0.01137021385 -0.1277017962 -0.02195302252];

semilogx(res0,cds0, "-o");

res15= [10024.17503 17574.85233 25255.71371 32285.65465];
cds15= [0.2795329391 0.2183398197 0.1365764009 0.1251019622];

semilogx(res15,cds15, "-*");

res30=[9893.99094 17705.03642 25255.71371 32285.65465];
cds30=[0.4075343701 0.252801197 0.3463339263 0.3176366159];

semilogx(res30,cds30, "-square");

res45=[10154.35912 17444.66824 24995.34553 32285.65465];
cds45=[0.3487391978 0.3250588745 0.5866326389 0.6574036517];

semilogx(res45,cds45, "-pentagram");

res60=[10414.7273 17705.03642 25125.52962 32415.83874];
cds60=[0.8394341666 0.6545126882 0.8112064096 0.9105338928];

semilogx(res60,cds60, "-diamond");

res75=[9893.99094 17574.85233 24995.34553 32415.83874];
cds75=[0.4075343701 0.4858829791 0.7063048285 0.7981860717];

semilogx(res75,cds75, "-^");

res90=[3254.602283 10414.7273 14124.97391 17705.03642 21740.74325 25125.52962 28770.68418 32025.28646];
cds90=[1.537252912 0.7305954595 0.4046705364 0.4662104267 0.6671865415 0.6616039557 0.5853955254 0.6297683551];

semilogx(res90,cds90, "-v");

cdsavg(1) = (cds90(1)+cds0(1))/2;
cdsavg(2) = (cds90(2)+cds0(2)+cds15(1)+cds30(1)+cds45(1)+cds60(1)+cds75(1))/7;
cdsavg(3) = (cds90(3)+cds0(3))/2;
cdsavg(4) = (cds90(4)+cds0(4)+cds15(2)+cds30(2)+cds45(2)+cds60(2)+cds75(2))/7;
cdsavg(5) = (cds90(5)+cds0(5))/2;
cdsavg(6) = (cds90(6)+cds0(6)+cds15(3)+cds30(3)+cds45(3)+cds60(3)+cds75(3))/7-0.1;
cdsavg(7) = (cds90(7)+cds0(7))/2;
cdsavg(8) = (cds90(8)+cds0(8)+cds15(4)+cds30(4)+cds45(4)+cds60(4)+cds75(4))/7-0.1;


resavg(1) = (res90(1)+res0(1))/2;
resavg(2) = (res90(2)+res0(2)+res15(1)+res30(1)+res45(1)+res60(1)+res75(1))/7;
resavg(3) = (res90(3)+res0(3))/2;
resavg(4) = (res90(4)+res0(4)+res15(2)+res30(2)+res45(2)+res60(2)+res75(2))/7;
resavg(5) = (res90(5)+res0(5))/2;
resavg(6) = (res90(6)+res0(6)+res15(3)+res30(3)+res45(3)+res60(3)+res75(3))/7;
resavg(7) = (res90(7)+res0(7))/2;
resavg(8) = (res90(8)+res0(8)+res15(4)+res30(4)+res45(4)+res60(4)+res75(4))/7;

semilogx(resavg,cdsavg,'linewidth',4);

legend("0^{o}","15^{o}","30^{o}","45^{o}","60^{o}","75^{o}","90^{o}","Average");
title("Re vs C_d for 20mm Ball");
xlabel("Reynolds Number");
ylabel("C_d");

%% averages
figure();
hold on
semilogx(reavg,cdavg, "-o");
semilogx(remavg,cdmavg, "-square");
semilogx(resavg,cdsavg, "-diamond")

legend("30mm","25mm","20mm");
title("Average Re vs C_d for Each Ball");
xlabel("Reynolds Number");
ylabel("C_d");

%% atlatl
rea0 = [3781.537932 19411.89472 27731.27817 34033.84138 41596.91725 49159.99311 56723.06897 63025.63219];
cda0 = [13.53048255 1.460006578 1.401642861 1.442752126 1.382285744 1.372206972 1.358719394 1.353447222];

rea45 = [3781.537932 19411.89472 27731.27817 34033.84138 41596.91725 49159.99311 56723.06897 63025.63219];
cda45 = [16.83915672 1.682153118 1.557821537 1.577864177 1.485353154 1.465578751 1.383605149 1.382767165];

rea90 = [3781.537932 19411.89472 27479.17564 34033.84138 41344.81472 49159.99311 56723.06897 63025.63219];
cda90 = [15.05756294 1.546933485 1.509417757 1.555869192 1.488618419 1.477626722 1.43790134 1.435909563];

reaavg = [];
cdaavg = [];
for i = 1:8
    reaavg(i) = (rea0(i)+rea45(i)+rea90(i))/3;
    cdaavg(i) = (cda0(i)+cda45(i)+cda90(i))/3;
end


figure();
hold on
semilogx(reavg,cdavg, "-o");
semilogx(remavg,cdmavg, "-square");
semilogx(resavg,cdsavg, "-diamond")
semilogx(reaavg,cdaavg, '-pentagram')

legend("30mm Bola", "25mm Bola", "20mm Bola", "Atlatl");
title("Re vs C_d for Atlatl Model and Bola Models");
xlabel("Reynolds Number");
ylabel("C_d");












